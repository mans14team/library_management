commands:
  01_enable_docker_logs:
    command: |
      mkdir -p /var/log/eb-docker
      chmod 777 /var/log/eb-docker
      if systemctl list-unit-files | grep -q eb-docker-log; then
        systemctl enable eb-docker-log
        systemctl start eb-docker-log
      fi

container_commands:
  01_reload_nginx:
    command: |
      if service nginx status > /dev/null 2>&1; then
        service nginx reload
      else
        service nginx start
      fi
    ignoreErrors: true

  02_wait_for_docker:
    command: |
      docker ps
      sleep 10
      curl -f http://localhost:80/actuator/health || true
    ignoreErrors: true