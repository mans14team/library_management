files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/02_docker_login.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # Docker 로그인
      echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin

container_commands:
  01_tag_image:
    command: |
      if docker images | grep -q "aws_beanstalk/staging-app"; then
        # 스테이징 이미지를 현재 이미지로 태그 변경
        docker tag aws_beanstalk/staging-app aws_beanstalk/current-app
        echo "Tagged staging app as current app"
      fi